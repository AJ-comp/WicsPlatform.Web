@page "/"
@attribute [Authorize]

<PageTitle>홈 - WICS 방송 관리 시스템</PageTitle>

<RadzenStack Gap="1.5rem">
    <!-- 헤더 섹션 -->
    <RadzenCard class="elegant-header-card">
        <RadzenStack Gap="0.5rem" Style="text-align: center;">
            <RadzenText TextStyle="TextStyle.H4" TagName="TagName.H1" class="main-title">
                WICS 방송 관리 시스템
            </RadzenText>
            <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center" Gap="0.25rem" class="welcome-message">
                <RadzenText TextStyle="TextStyle.Body2" class="greeting-text">환영합니다,</RadzenText>
                <RadzenText TextStyle="TextStyle.Body2" class="user-name">@(Security.User?.Name ?? "손님")</RadzenText>
            </RadzenStack>
            <div class="decorative-line"></div>
        </RadzenStack>
    </RadzenCard>

    <!-- 통계 카드 섹션 -->
    <RadzenRow Gap="1rem">
        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stat-card" Style="height: 100%;">
                <RadzenStack Gap="0.75rem" Style="text-align: center;">
                    <div class="stat-icon-frame">
                        <RadzenIcon Icon="settings_input_antenna" Style="font-size: 1.5rem;" />
                    </div>
                    <RadzenText TextStyle="TextStyle.H3" class="stat-number">@totalChannels</RadzenText>
                    <RadzenText TextStyle="TextStyle.Overline" class="stat-title">전체 채널</RadzenText>
                    <RadzenBadge BadgeStyle="BadgeStyle.Success" Text="활성" Variant="Variant.Outlined" IsPill="true" />
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stat-card" Style="height: 100%;">
                <RadzenStack Gap="0.75rem" Style="text-align: center;">
                    <div class="stat-icon-frame">
                        <RadzenIcon Icon="speaker" Style="font-size: 1.5rem;" />
                    </div>
                    <RadzenText TextStyle="TextStyle.H3" class="stat-number">@totalSpeakers</RadzenText>
                    <RadzenText TextStyle="TextStyle.Overline" class="stat-title">전체 스피커</RadzenText>
                    <RadzenBadge BadgeStyle="BadgeStyle.Info" Text="@($"{onlineSpeakers} 온라인")" Variant="Variant.Outlined" IsPill="true" />
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stat-card" Style="height: 100%;">
                <RadzenStack Gap="0.75rem" Style="text-align: center;">
                    <div class="stat-icon-frame">
                        <RadzenIcon Icon="audio_file" Style="font-size: 1.5rem;" />
                    </div>
                    <RadzenText TextStyle="TextStyle.H3" class="stat-number">@totalMedia</RadzenText>
                    <RadzenText TextStyle="TextStyle.Overline" class="stat-title">미디어 파일</RadzenText>
                    <RadzenBadge BadgeStyle="BadgeStyle.Warning" Text="@totalSize" Variant="Variant.Outlined" IsPill="true" />
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stat-card" Style="height: 100%;">
                <RadzenStack Gap="0.75rem" Style="text-align: center;">
                    <div class="stat-icon-frame">
                        <RadzenIcon Icon="record_voice_over" Style="font-size: 1.5rem;" />
                    </div>
                    <RadzenText TextStyle="TextStyle.H3" class="stat-number">@totalTts</RadzenText>
                    <RadzenText TextStyle="TextStyle.Overline" class="stat-title">음성 메시지</RadzenText>
                    <RadzenBadge BadgeStyle="BadgeStyle.Success" Text="증가중" Variant="Variant.Outlined" IsPill="true" />
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>

    <!-- 퀵 액션 섹션 -->
    <RadzenCard class="quick-actions-card">
        <RadzenStack Gap="1rem">
            <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.Center" AlignItems="AlignItems.Center" Gap="0.75rem">
                <RadzenText TextStyle="TextStyle.Subtitle1" class="section-ornament">❖</RadzenText>
                <RadzenText TextStyle="TextStyle.H6" class="section-title-elegant">빠른 실행</RadzenText>
                <RadzenText TextStyle="TextStyle.Subtitle1" class="section-ornament">❖</RadzenText>
            </RadzenStack>

            <RadzenRow Gap="1rem">
                <RadzenColumn Size="6" SizeMD="3">
                    <RadzenButton Click="@(() => NavigationManager.NavigateTo("/manage-broad-cast"))" 
                                  Variant="Variant.Outlined" 
                                  ButtonStyle="ButtonStyle.Primary"
                                  Style="width: 100%; height: 100px;">
                        <RadzenStack Gap="0.25rem" Style="align-items: center;">
                            <RadzenIcon Icon="play_circle" Style="font-size: 1.75rem;" />
                            <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 600;">방송 시작</RadzenText>
                            <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">실시간 송출 시작</RadzenText>
                        </RadzenStack>
                    </RadzenButton>
                </RadzenColumn>

                <RadzenColumn Size="6" SizeMD="3">
                    <RadzenButton Click="@(() => NavigationManager.NavigateTo("/manage-speaker"))" 
                                  Variant="Variant.Outlined" 
                                  ButtonStyle="ButtonStyle.Secondary"
                                  Style="width: 100%; height: 100px;">
                        <RadzenStack Gap="0.25rem" Style="align-items: center;">
                            <RadzenIcon Icon="add_circle" Style="font-size: 1.75rem;" />
                            <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 600;">스피커 추가</RadzenText>
                            <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">새 장치 등록</RadzenText>
                        </RadzenStack>
                    </RadzenButton>
                </RadzenColumn>

                <RadzenColumn Size="6" SizeMD="3">
                    <RadzenButton Click="@(() => NavigationManager.NavigateTo("/manage-media"))" 
                                  Variant="Variant.Outlined" 
                                  ButtonStyle="ButtonStyle.Warning"
                                  Style="width: 100%; height: 100px;">
                        <RadzenStack Gap="0.25rem" Style="align-items: center;">
                            <RadzenIcon Icon="cloud_upload" Style="font-size: 1.75rem;" />
                            <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 600;">미디어 업로드</RadzenText>
                            <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">오디오 파일 추가</RadzenText>
                        </RadzenStack>
                    </RadzenButton>
                </RadzenColumn>

                <RadzenColumn Size="6" SizeMD="3">
                    <RadzenButton Click="@(() => NavigationManager.NavigateTo("/manage-media?tab=tts"))" 
                                  Variant="Variant.Outlined" 
                                  ButtonStyle="ButtonStyle.Success"
                                  Style="width: 100%; height: 100px;">
                        <RadzenStack Gap="0.25rem" Style="align-items: center;">
                            <RadzenIcon Icon="mic" Style="font-size: 1.75rem;" />
                            <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 600;">음성 생성</RadzenText>
                            <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">TTS 메시지 작성</RadzenText>
                        </RadzenStack>
                    </RadzenButton>
                </RadzenColumn>
            </RadzenRow>
        </RadzenStack>
    </RadzenCard>

    <!-- 최근 활동 및 시스템 상태 -->
    <RadzenRow Gap="1rem">
        <!-- 최근 방송 활동 -->
        <RadzenColumn Size="12" SizeMD="8">
            <RadzenCard Style="height: 100%;">
                <RadzenStack Gap="1rem">
                    <RadzenStack Gap="0.25rem" class="panel-header-content">
                        <RadzenText TextStyle="TextStyle.H6" class="panel-title">최근 활동</RadzenText>
                        <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">방송 기록 및 이벤트</RadzenText>
                    </RadzenStack>

                    @if (isLoadingActivities)
                    {
                        <RadzenStack Gap="1rem" Style="align-items: center; padding: 3rem 0;">
                            <RadzenProgressBarCircular ShowValue="false" Mode="ProgressBarMode.Indeterminate" Size="ProgressBarCircularSize.Medium" />
                            <RadzenText TextStyle="TextStyle.Caption">활동 내역을 불러오는 중...</RadzenText>
                        </RadzenStack>
                    }
                    else if (recentActivities.Any())
                    {
                        <RadzenStack Gap="1rem" class="activity-timeline">
                            @foreach (var activity in recentActivities.Take(5))
                            {
                                <RadzenCard Variant="Variant.Outlined" Style="padding: 0.75rem;">
                                    <RadzenStack Orientation="Orientation.Horizontal" Gap="0.75rem" AlignItems="AlignItems.Start">
                                        <RadzenBadge BadgeStyle="@GetActivityBadgeStyle(activity.Type)" 
                                                     Variant="Variant.Filled" 
                                                     Style="padding: 0.5rem; border-radius: 50%;">
                                            <RadzenIcon Icon="@GetActivityIcon(activity.Type)" Style="font-size: 1rem;" />
                                        </RadzenBadge>
                                        <RadzenStack Gap="0.25rem" Style="flex: 1;">
                                            <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 500;">@activity.Description</RadzenText>
                                            <RadzenStack Orientation="Orientation.Horizontal" Gap="0.5rem">
                                                <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">작성자: @activity.User</RadzenText>
                                                <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.5;">•</RadzenText>
                                                <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">@activity.Timestamp.ToString("yyyy년 MM월 dd일 HH:mm")</RadzenText>
                                            </RadzenStack>
                                        </RadzenStack>
                                    </RadzenStack>
                                </RadzenCard>
                            }
                        </RadzenStack>
                    }
                    else
                    {
                        <RadzenStack Gap="1rem" Style="align-items: center; padding: 3rem 0;">
                            <div class="empty-icon-wrapper">
                                <RadzenIcon Icon="event_note" Style="font-size: 2rem; opacity: 0.3;" />
                            </div>
                            <RadzenText TextStyle="TextStyle.Body2" Style="opacity: 0.7;">최근 활동이 없습니다</RadzenText>
                            <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.5;">방송 이벤트가 여기에 표시됩니다</RadzenText>
                        </RadzenStack>
                    }
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <!-- 시스템 상태 -->
        <RadzenColumn Size="12" SizeMD="4">
            <RadzenCard Style="height: 100%;">
                <RadzenStack Gap="1rem">
                    <RadzenStack Gap="0.25rem" class="panel-header-content">
                        <RadzenText TextStyle="TextStyle.H6" class="panel-title">시스템 상태</RadzenText>
                        <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">인프라 상태 모니터링</RadzenText>
                    </RadzenStack>

                    <RadzenStack Gap="0.75rem">
                        <!-- 서버 상태 -->
                        <RadzenCard Variant="Variant.Outlined" Style="padding: 0.75rem;">
                            <RadzenStack Orientation="Orientation.Horizontal" Gap="0.75rem" AlignItems="AlignItems.Center">
                                <div class="status-icon-box">
                                    <RadzenIcon Icon="dns" Style="font-size: 1.25rem;" />
                                </div>
                                <RadzenStack Gap="0" Style="flex: 1;">
                                    <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 500;">서버</RadzenText>
                                    <RadzenBadge BadgeStyle="BadgeStyle.Success" Text="정상 작동" Variant="Variant.Text" Style="padding: 0;" />
                                </RadzenStack>
                            </RadzenStack>
                        </RadzenCard>

                        <!-- 데이터베이스 상태 -->
                        <RadzenCard Variant="Variant.Outlined" Style="padding: 0.75rem;">
                            <RadzenStack Orientation="Orientation.Horizontal" Gap="0.75rem" AlignItems="AlignItems.Center">
                                <div class="status-icon-box">
                                    <RadzenIcon Icon="storage" Style="font-size: 1.25rem;" />
                                </div>
                                <RadzenStack Gap="0" Style="flex: 1;">
                                    <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 500;">데이터베이스</RadzenText>
                                    <RadzenBadge BadgeStyle="BadgeStyle.Success" Text="양호" Variant="Variant.Text" Style="padding: 0;" />
                                </RadzenStack>
                            </RadzenStack>
                        </RadzenCard>

                        <!-- 네트워크 상태 -->
                        <RadzenCard Variant="Variant.Outlined" Style="padding: 0.75rem;">
                            <RadzenStack Orientation="Orientation.Horizontal" Gap="0.75rem" AlignItems="AlignItems.Center">
                                <div class="status-icon-box">
                                    <RadzenIcon Icon="wifi" Style="font-size: 1.25rem;" />
                                </div>
                                <RadzenStack Gap="0" Style="flex: 1;">
                                    <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 500;">네트워크</RadzenText>
                                    <RadzenBadge BadgeStyle="BadgeStyle.Info" Text="연결됨" Variant="Variant.Text" Style="padding: 0;" />
                                </RadzenStack>
                            </RadzenStack>
                        </RadzenCard>

                        <!-- 스토리지 사용량 -->
                        <RadzenCard Variant="Variant.Outlined" Style="padding: 0.75rem;">
                            <RadzenStack Gap="0.5rem">
                                <RadzenStack Orientation="Orientation.Horizontal" Gap="0.75rem" AlignItems="AlignItems.Center">
                                    <div class="status-icon-box">
                                        <RadzenIcon Icon="folder" Style="font-size: 1.25rem;" />
                                    </div>
                                    <RadzenStack Gap="0" Style="flex: 1;">
                                        <RadzenText TextStyle="TextStyle.Subtitle2" Style="font-weight: 500;">스토리지</RadzenText>
                                        <RadzenText TextStyle="TextStyle.Caption" Style="opacity: 0.7;">@storageUsage% 사용중</RadzenText>
                                    </RadzenStack>
                                </RadzenStack>
                                <RadzenProgressBar Value="@storageUsage" Max="100" ShowValue="false" 
                                                   ProgressBarStyle="@(storageUsage > 80 ? ProgressBarStyle.Danger : ProgressBarStyle.Primary)" 
                                                   Style="height: 6px;" />
                            </RadzenStack>
                        </RadzenCard>
                    </RadzenStack>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>
</RadzenStack>

<style>
    /* Radzen 컴포넌트 기반 커스텀 스타일 */
    .elegant-header-card {
        background: linear-gradient(to bottom, var(--rz-base-background-color), var(--rz-panel-background-color)) !important;
        border-bottom: 2px solid var(--rz-primary) !important;
    }

    .main-title {
        font-family: 'Nanum Myeongjo', 'Georgia', serif !important;
        font-weight: 300 !important;
        letter-spacing: 2px !important;
        color: var(--rz-text-color) !important;
    }

    .welcome-message {
        font-size: 0.875rem;
    }

    .greeting-text {
        opacity: 0.8;
        font-style: italic;
    }

    .user-name {
        font-weight: 600 !important;
        color: var(--rz-primary) !important;
    }

    .decorative-line {
        width: 80px;
        height: 2px;
        background: linear-gradient(to right, transparent, var(--rz-primary), transparent);
        margin: 0.5rem auto;
    }

    .stat-card {
        transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .stat-card:hover {
        transform: translateY(-4px);
        box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15) !important;
    }

    .stat-icon-frame {
        width: 60px;
        height: 60px;
        margin: 0 auto;
        border: 2px solid var(--rz-primary);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--rz-panel-background-color);
        color: var(--rz-primary);
    }

    .stat-number {
        font-family: 'Nanum Myeongjo', 'Georgia', serif !important;
        font-weight: 300 !important;
        margin: 0 !important;
    }

    .stat-title {
        letter-spacing: 1px;
        opacity: 0.8;
    }

    .quick-actions-card {
        background: var(--rz-panel-background-color) !important;
        border: 1px solid var(--rz-border-color) !important;
    }

    .section-ornament {
        color: var(--rz-primary) !important;
    }

    .section-title-elegant {
        font-family: 'Nanum Myeongjo', 'Georgia', serif !important;
        font-weight: 300 !important;
        letter-spacing: 1px;
    }

    .panel-header-content {
        padding-bottom: 0.75rem;
        border-bottom: 1px solid var(--rz-border-color);
    }

    .panel-title {
        font-family: 'Nanum Myeongjo', 'Georgia', serif !important;
        font-weight: 600 !important;
        letter-spacing: 0.5px;
    }

    .activity-timeline {
        max-height: 500px;
        overflow-y: auto;
    }

    .empty-icon-wrapper {
        width: 60px;
        height: 60px;
        margin: 0 auto;
        border: 2px solid var(--rz-border-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .status-icon-box {
        width: 40px;
        height: 40px;
        border-radius: 8px;
        background: var(--rz-panel-background-color);
        border: 1px solid var(--rz-border-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--rz-primary);
    }

    /* 다크 테마 최적화 */
    :root[data-theme='dark'] .elegant-header-card {
        background: linear-gradient(180deg, #181712, #141310) !important;
        border-bottom-color: var(--rz-primary) !important;
    }

    :root[data-theme='dark'] .stat-icon-frame,
    :root[data-theme='dark'] .status-icon-box {
        background: #171612 !important;
        border-color: var(--rz-primary) !important;
    }

    :root[data-theme='dark'] .quick-actions-card {
        background: linear-gradient(180deg, #1a1916, #141310) !important;
    }

    /* 스크롤바 스타일링 */
    .activity-timeline::-webkit-scrollbar {
        width: 6px;
    }

    .activity-timeline::-webkit-scrollbar-track {
        background: var(--rz-panel-background-color);
        border-radius: 3px;
    }

    .activity-timeline::-webkit-scrollbar-thumb {
        background: var(--rz-border-color);
        border-radius: 3px;
    }

    .activity-timeline::-webkit-scrollbar-thumb:hover {
        background: var(--rz-primary);
    }
</style>