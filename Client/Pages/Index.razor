@page "/"
@attribute [Authorize]

<PageTitle>홈 - WICS 방송 관리 시스템</PageTitle>

<RadzenStack>
    <!-- 헤더 섹션 -->
    <RadzenRow class="mb-4">
        <RadzenColumn Size="12">
            <RadzenText Text="WICS 방송 관리 시스템" TextStyle="TextStyle.DisplayH4" TagName="TagName.H1"
                        Style="margin: 0; font-weight: 600; color: var(--rz-text-title-color);" />
            <RadzenText Text="@($"안녕하세요, {Security.User?.Name ?? "사용자"}님. 오늘도 좋은 하루 되세요!")"
                        TextStyle="TextStyle.H6" Class="mb-0 mt-2" Style="color: var(--rz-text-secondary-color);" />
        </RadzenColumn>
    </RadzenRow>

    <!-- 통계 카드 섹션 -->
    <RadzenRow Gap="1rem" class="mb-4">
        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stats-card">
                <RadzenStack Gap="0.5rem">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                        <RadzenIcon Icon="settings_input_antenna" Style="font-size: 2.5rem; color: var(--rz-primary);" />
                        <RadzenBadge BadgeStyle="BadgeStyle.Success" IsPill="true" Text="활성" />
                    </RadzenStack>
                    <RadzenText TextStyle="TextStyle.H4" class="mb-0">@totalChannels</RadzenText>
                    <RadzenText TextStyle="TextStyle.Body2" class="text-muted mb-0">전체 채널</RadzenText>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stats-card">
                <RadzenStack Gap="0.5rem">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                        <RadzenIcon Icon="speaker" Style="font-size: 2.5rem; color: var(--rz-info);" />
                        <RadzenText TextStyle="TextStyle.Caption" class="text-success">
                            @onlineSpeakers 온라인
                        </RadzenText>
                    </RadzenStack>
                    <RadzenText TextStyle="TextStyle.H4" class="mb-0">@totalSpeakers</RadzenText>
                    <RadzenText TextStyle="TextStyle.Body2" class="text-muted mb-0">전체 스피커</RadzenText>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stats-card">
                <RadzenStack Gap="0.5rem">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                        <RadzenIcon Icon="audio_file" Style="font-size: 2.5rem; color: var(--rz-warning);" />
                        <RadzenText TextStyle="TextStyle.Caption" class="text-muted">
                            @totalSize
                        </RadzenText>
                    </RadzenStack>
                    <RadzenText TextStyle="TextStyle.H4" class="mb-0">@totalMedia</RadzenText>
                    <RadzenText TextStyle="TextStyle.Body2" class="text-muted mb-0">미디어 파일</RadzenText>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>

        <RadzenColumn Size="12" SizeSM="6" SizeMD="3">
            <RadzenCard class="stats-card">
                <RadzenStack Gap="0.5rem">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                        <RadzenIcon Icon="record_voice_over" Style="font-size: 2.5rem; color: var(--rz-success);" />
                        <RadzenIcon Icon="trending_up" Style="color: var(--rz-success);" />
                    </RadzenStack>
                    <RadzenText TextStyle="TextStyle.H4" class="mb-0">@totalTts</RadzenText>
                    <RadzenText TextStyle="TextStyle.Body2" class="text-muted mb-0">TTS 메시지</RadzenText>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>

    <!-- 퀵 액션 섹션 -->
    <RadzenRow Gap="1rem" class="mb-4">
        <RadzenColumn Size="12">
            <RadzenCard>
                <RadzenText TextStyle="TextStyle.H6" class="mb-3">
                    <RadzenIcon Icon="flash_on" class="me-2" />
                    빠른 작업
                </RadzenText>
                <RadzenRow Gap="1rem">
                    <RadzenColumn Size="6" SizeMD="3">
                        <RadzenButton Text="방송 시작"
                                      Icon="play_circle"
                                      ButtonStyle="ButtonStyle.Primary"
                                      Size="ButtonSize.Large"
                                      Style="width: 100%; height: 80px;"
                                      Click="@(() => NavigationManager.NavigateTo("/manage-broad-cast"))" />
                    </RadzenColumn>
                    <RadzenColumn Size="6" SizeMD="3">
                        <RadzenButton Text="스피커 추가"
                                      Icon="add_circle"
                                      ButtonStyle="ButtonStyle.Secondary"
                                      Size="ButtonSize.Large"
                                      Style="width: 100%; height: 80px;"
                                      Click="@(() => NavigationManager.NavigateTo("/manage-speaker"))" />
                    </RadzenColumn>
                    <RadzenColumn Size="6" SizeMD="3">
                        <RadzenButton Text="미디어 업로드"
                                      Icon="cloud_upload"
                                      ButtonStyle="ButtonStyle.Info"
                                      Size="ButtonSize.Large"
                                      Style="width: 100%; height: 80px;"
                                      Click="@(() => NavigationManager.NavigateTo("/manage-media"))" />
                    </RadzenColumn>
                    <RadzenColumn Size="6" SizeMD="3">
                        <RadzenButton Text="TTS 생성"
                                      Icon="mic"
                                      ButtonStyle="ButtonStyle.Success"
                                      Size="ButtonSize.Large"
                                      Style="width: 100%; height: 80px;"
                                      Click="@(() => NavigationManager.NavigateTo("/manage-tts"))" />
                    </RadzenColumn>
                </RadzenRow>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>

    <!-- 최근 활동 및 시스템 상태 -->
    <RadzenRow Gap="1rem">
        <!-- 최근 방송 활동 -->
        <RadzenColumn Size="12" SizeMD="8">
            <RadzenCard class="h-100">
                <RadzenText TextStyle="TextStyle.H6" class="mb-3">
                    <RadzenIcon Icon="history" class="me-2" />
                    최근 방송 활동
                </RadzenText>
                @if (isLoadingActivities)
                {
                    <div class="text-center py-4">
                        <RadzenProgressBar Value="100" ShowValue="false" Mode="ProgressBarMode.Indeterminate"
                                           Style="width: 60%; height: 6px; margin: 0 auto;" />
                    </div>
                }
                else if (recentActivities.Any())
                {
                    <RadzenDataGrid Data="@recentActivities"
                                    TItem="RecentActivity"
                                    AllowAlternatingRows="false"
                                    AllowPaging="false"
                                    PageSize="5"
                                    GridLines="Radzen.DataGridGridLines.None">
                        <Columns>
                            <RadzenDataGridColumn TItem="RecentActivity" Width="50px" TextAlign="TextAlign.Center">
                                <Template Context="activity">
                                    <RadzenIcon Icon="@GetActivityIcon(activity.Type)"
                                                Style="@($"color: {GetActivityColor(activity.Type)};")" />
                                </Template>
                            </RadzenDataGridColumn>
                            <RadzenDataGridColumn TItem="RecentActivity" Property="Description" Title="활동 내용" />
                            <RadzenDataGridColumn TItem="RecentActivity" Property="User" Title="사용자" Width="120px" />
                            <RadzenDataGridColumn TItem="RecentActivity" Property="Timestamp" Title="시간" Width="150px"
                                                  FormatString="{0:yyyy-MM-dd HH:mm}" />
                        </Columns>
                    </RadzenDataGrid>
                }
                else
                {
                    <div class="text-center py-5">
                        <RadzenIcon Icon="event_note" Style="font-size: 3rem; color: var(--rz-text-disabled-color);" />
                        <RadzenText TextStyle="TextStyle.Body1" class="mt-2 mb-0">
                            최근 활동이 없습니다
                        </RadzenText>
                    </div>
                }
            </RadzenCard>
        </RadzenColumn>

        <!-- 시스템 상태 -->
        <RadzenColumn Size="12" SizeMD="4">
            <RadzenCard class="h-100">
                <RadzenText TextStyle="TextStyle.H6" class="mb-3">
                    <RadzenIcon Icon="monitor_heart" class="me-2" />
                    시스템 상태
                </RadzenText>
                <RadzenStack Gap="1rem">
                    <!-- 서버 상태 -->
                    <RadzenCard class="system-status-item">
                        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                                <RadzenIcon Icon="dns" />
                                <RadzenText TextStyle="TextStyle.Body2" class="mb-0">서버 상태</RadzenText>
                            </RadzenStack>
                            <RadzenBadge BadgeStyle="BadgeStyle.Success" IsPill="true" Text="정상" />
                        </RadzenStack>
                    </RadzenCard>

                    <!-- 데이터베이스 상태 -->
                    <RadzenCard class="system-status-item">
                        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                                <RadzenIcon Icon="storage" />
                                <RadzenText TextStyle="TextStyle.Body2" class="mb-0">데이터베이스</RadzenText>
                            </RadzenStack>
                            <RadzenBadge BadgeStyle="BadgeStyle.Success" IsPill="true" Text="정상" />
                        </RadzenStack>
                    </RadzenCard>

                    <!-- 네트워크 상태 -->
                    <RadzenCard class="system-status-item">
                        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                                <RadzenIcon Icon="wifi" />
                                <RadzenText TextStyle="TextStyle.Body2" class="mb-0">네트워크</RadzenText>
                            </RadzenStack>
                            <RadzenBadge BadgeStyle="BadgeStyle.Success" IsPill="true" Text="연결됨" />
                        </RadzenStack>
                    </RadzenCard>

                    <!-- 스토리지 사용량 -->
                    <RadzenCard class="system-status-item">
                        <RadzenStack Gap="0.5rem">
                            <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" JustifyContent="JustifyContent.SpaceBetween">
                                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                                    <RadzenIcon Icon="folder" />
                                    <RadzenText TextStyle="TextStyle.Body2" class="mb-0">스토리지</RadzenText>
                                </RadzenStack>
                                <RadzenText TextStyle="TextStyle.Caption" class="mb-0">@storageUsage%</RadzenText>
                            </RadzenStack>
                            <RadzenProgressBar Value="@storageUsage" ShowValue="false"
                                               ProgressBarStyle="@(storageUsage > 80 ? ProgressBarStyle.Danger : ProgressBarStyle.Primary)" />
                        </RadzenStack>
                    </RadzenCard>
                </RadzenStack>
            </RadzenCard>
        </RadzenColumn>
    </RadzenRow>
</RadzenStack>

<style>
    /* 통계 카드 스타일 */
    .stats-card {
        transition: all 0.3s ease;
        border: 1px solid var(--rz-border-light);
    }

        .stats-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }

    /* 시스템 상태 아이템 스타일 */
    .system-status-item {
        background-color: var(--rz-base-100);
        border: 1px solid var(--rz-border-lighter);
        padding: 0.75rem !important;
    }

    /* 퀵 액션 버튼 스타일 개선 */
    .rz-button-lg {
        font-size: 1rem;
        font-weight: 500;
        transition: all 0.2s ease;
    }

        .rz-button-lg:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .rz-button-lg .rz-button-icon {
            font-size: 1.5rem !important;
            margin-bottom: 0.25rem;
        }

    /* 헤더 그라디언트 효과 */
    h1 {
        background: linear-gradient(135deg, var(--rz-primary) 0%, var(--rz-primary-dark) 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    /* 데이터그리드 스타일 개선 */
    .rz-datatable-data td {
        padding: 0.75rem 1rem !important;
        border-bottom: 1px solid var(--rz-border-lighter) !important;
    }

    /* 다크 테마 지원 */
    :root[data-theme='dark'] .stats-card {
        background-color: var(--rz-base-100);
        border-color: var(--rz-border);
    }

    :root[data-theme='dark'] .system-status-item {
        background-color: var(--rz-base-200);
        border-color: var(--rz-border);
    }

    :root[data-theme='dark'] .stats-card:hover {
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
    }
</style>