@attribute [Authorize]

<RadzenStack Gap="1rem" Style="width: 100%;">
    <!-- 헤더 카드 -->
    <RadzenCard Variant="Variant.Outlined" class="header-card">
        <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.75rem">
            <div class="icon-wrapper">
                <RadzenIcon Icon="edit" Style="font-size: 1.5rem; color: var(--rz-primary);" />
            </div>
            <RadzenStack Gap="0.25rem">
                <RadzenText TextStyle="TextStyle.H6" class="mb-0" Style="color: var(--rz-text-color); font-weight: 600;">
                    TTS 메시지 수정
                </RadzenText>
                <RadzenText TextStyle="TextStyle.Caption" class="mb-0" Style="color: var(--rz-text-secondary-color); font-size: 0.75rem;">
                    기존 TTS 메시지의 내용을 수정하고 업데이트합니다
                </RadzenText>
            </RadzenStack>
        </RadzenStack>
    </RadzenCard>

    <!-- 폼 섹션 -->
    <RadzenTemplateForm TItem="TtsEditFormModel" Data="@model" Submit="@FormSubmit">
        <!-- 에러 알림 -->
        @if (errorVisible)
        {
            <RadzenAlert AlertStyle="AlertStyle.Danger"
                         Variant="Variant.Flat"
                         Size="AlertSize.Small"
                         class="error-alert">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                    <RadzenIcon Icon="error_outline" />
                    <RadzenText TextStyle="TextStyle.Caption">@error</RadzenText>
                </RadzenStack>
            </RadzenAlert>
        }

        <!-- 기본 정보 섹션 -->
        <RadzenCard class="section-card">
            <RadzenStack Gap="1rem">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem" class="section-header">
                    <RadzenIcon Icon="info" class="section-icon primary" />
                    <RadzenText TextStyle="TextStyle.Subtitle2" class="section-title">TTS 정보</RadzenText>
                </RadzenStack>

                <!-- 제목 필드 -->
                <RadzenRow Gap="0.5rem">
                    <RadzenColumn Size="12">
                        <RadzenFormField Text="제목" Variant="Variant.Outlined" class="form-field">
                            <ChildContent>
                                <RadzenTextBox @bind-Value="@model.Name"
                                               Placeholder="예: 오전 안내 방송"
                                               Name="Name"
                                               class="input-field" />
                            </ChildContent>
                            <Helper>
                                <RadzenText TextStyle="TextStyle.Caption" class="field-hint">
                                    <RadzenIcon Icon="label" class="hint-icon" />
                                    TTS 메시지를 쉽게 식별할 수 있는 제목을 입력하세요
                                </RadzenText>
                            </Helper>
                        </RadzenFormField>
                        <RadzenRequiredValidator Component="Name"
                                                 Text="제목은 필수 입력 항목입니다" />
                    </RadzenColumn>
                </RadzenRow>

                <!-- 내용 필드 -->
                <RadzenRow Gap="0.5rem">
                    <RadzenColumn Size="12">
                        <RadzenFormField Text="음성 변환 텍스트" Variant="Variant.Outlined" class="form-field">
                            <ChildContent>
                                <RadzenTextArea @bind-Value="@model.Content"
                                                Rows="6"
                                                Placeholder="음성으로 변환할 텍스트를 입력하세요..."
                                                Name="Content"
                                                class="input-field" />
                            </ChildContent>
                            <Helper>
                                <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.SpaceBetween">
                                    <RadzenText TextStyle="TextStyle.Caption" class="field-hint">
                                        <RadzenIcon Icon="description" class="hint-icon" />
                                        명확한 발음을 위해 문장 부호를 적절히 사용하세요
                                    </RadzenText>
                                    <RadzenText TextStyle="TextStyle.Caption" Style="color: var(--rz-primary); font-weight: 600;">
                                        @(model.Content?.Length ?? 0) / 1000
                                    </RadzenText>
                                </RadzenStack>
                            </Helper>
                        </RadzenFormField>
                        <RadzenRequiredValidator Component="Content"
                                                 Text="내용은 필수 입력 항목입니다" />
                    </RadzenColumn>
                </RadzenRow>
            </RadzenStack>
        </RadzenCard>

        <!-- 정보 카드 -->
        <RadzenCard class="info-card">
            <RadzenStack Gap="0.75rem">
                <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                    <RadzenIcon Icon="lightbulb" class="info-icon" />
                    <RadzenText TextStyle="TextStyle.Subtitle2" class="info-title">수정 안내</RadzenText>
                </RadzenStack>
                <RadzenStack Gap="0.5rem" class="info-list">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Gap="0.5rem">
                        <RadzenIcon Icon="check_circle" class="check-icon" />
                        <RadzenText TextStyle="TextStyle.Caption">수정된 내용은 즉시 적용됩니다</RadzenText>
                    </RadzenStack>
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Gap="0.5rem">
                        <RadzenIcon Icon="check_circle" class="check-icon" />
                        <RadzenText TextStyle="TextStyle.Caption">현재 방송 중인 TTS는 다음 재생부터 변경사항이 적용됩니다</RadzenText>
                    </RadzenStack>
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Gap="0.5rem">
                        <RadzenIcon Icon="check_circle" class="check-icon" />
                        <RadzenText TextStyle="TextStyle.Caption">최대 1000자까지 입력 가능합니다</RadzenText>
                    </RadzenStack>
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Start" Gap="0.5rem">
                        <RadzenIcon Icon="check_circle" class="check-icon" />
                        <RadzenText TextStyle="TextStyle.Caption">마지막 수정: @(originalTts?.UpdatedAt.ToString("yyyy-MM-dd HH:mm") ?? "-")</RadzenText>
                    </RadzenStack>
                </RadzenStack>
            </RadzenStack>
        </RadzenCard>

        <!-- 액션 버튼 섹션 -->
        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" AlignItems="AlignItems.Center" Gap="0.75rem" class="dialog-actions">
            <RadzenButton ButtonStyle="ButtonStyle.Light"
                          Text="취소"
                          Icon="close"
                          Click="@CancelClick"
                          Size="ButtonSize.Medium"
                          Disabled="@isProcessing" />
            @if (isProcessing)
            {
                <RadzenButton ButtonType="ButtonType.Submit"
                              Text="저장 중..."
                              Icon="sync"
                              ButtonStyle="ButtonStyle.Primary"
                              Size="ButtonSize.Medium"
                              IsBusy="true"
                              Disabled="true" />
            }
            else
            {
                <RadzenButton ButtonType="ButtonType.Submit"
                              Icon="save"
                              Text="저장"
                              ButtonStyle="ButtonStyle.Primary"
                              Size="ButtonSize.Medium" />
            }
        </RadzenStack>
    </RadzenTemplateForm>
</RadzenStack>

<style>
    /* 헤더 카드 */
    .header-card {
        background: linear-gradient(135deg, var(--rz-primary-lighter) 0%, var(--rz-base-background-color) 100%);
        border: 1px solid var(--rz-primary-light);
    }

    .icon-wrapper {
        width: 3rem;
        height: 3rem;
        display: flex;
        align-items: center;
        justify-content: center;
        background: var(--rz-base-background-color);
        border-radius: var(--rz-border-radius);
        border: 1px solid var(--rz-primary-light);
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    }

    /* 에러 알림 */
    .error-alert {
        padding: 0.75rem !important;
        border-radius: var(--rz-border-radius) !important;
    }

    /* 섹션 카드 */
    .section-card {
        padding: 1.25rem !important;
        background: rgba(var(--rz-primary-rgb), 0.03) !important;
        border: 1px solid var(--rz-border-color) !important;
        border-radius: var(--rz-border-radius) !important;
        transition: all 0.2s ease;
    }

        .section-card:hover {
            background: rgba(var(--rz-primary-rgb), 0.05) !important;
            box-shadow: var(--rz-shadow-2) !important;
        }

    /* 섹션 헤더 */
    .section-header {
        padding-bottom: 0.75rem;
        border-bottom: 2px solid rgba(var(--rz-primary-rgb), 0.2);
    }

    .section-icon {
        font-size: 1.125rem !important;
    }

        .section-icon.primary {
            color: var(--rz-primary) !important;
        }

    .section-title {
        margin: 0 !important;
        font-weight: 600 !important;
        color: var(--rz-text-color) !important;
    }

    /* 폼 필드 */
    .form-field {
        width: 100%;
    }

    .input-field {
        width: 100% !important;
        font-size: 0.875rem !important;
    }

    .field-hint {
        display: flex;
        align-items: center;
        gap: 0.375rem;
        margin-top: 0.25rem;
        color: var(--rz-text-secondary-color) !important;
        font-size: 0.75rem !important;
    }

    .hint-icon {
        font-size: 0.75rem !important;
        color: var(--rz-text-tertiary-color) !important;
    }

    /* 정보 카드 */
    .info-card {
        padding: 1.25rem !important;
        background: rgba(var(--rz-info-rgb), 0.05) !important;
        border: 1px solid rgba(var(--rz-info-rgb), 0.2) !important;
        border-radius: var(--rz-border-radius) !important;
    }

    .info-icon {
        font-size: 1.25rem !important;
        color: var(--rz-info) !important;
    }

    .info-title {
        margin: 0 !important;
        font-weight: 600 !important;
        color: var(--rz-text-color) !important;
    }

    .info-list {
        margin: 0 !important;
    }

    .check-icon {
        font-size: 0.875rem !important;
        color: var(--rz-success) !important;
        flex-shrink: 0;
        margin-top: 2px;
    }

    /* 액션 버튼 섹션 */
    .dialog-actions {
        padding-top: 1rem;
        border-top: 1px solid var(--rz-border-color);
        margin-right: 0.5rem;
    }

    /* 애니메이션 */
    @@keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }

        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .section-card {
        animation: fadeIn 0.3s ease-out;
    }

    /* 스크롤바 스타일 */
    ::deep .rz-textarea::-webkit-scrollbar {
        width: 8px;
    }

    ::deep .rz-textarea::-webkit-scrollbar-track {
        background: var(--rz-base-background-color);
        border-radius: 4px;
    }

    ::deep .rz-textarea::-webkit-scrollbar-thumb {
        background: var(--rz-border-color);
        border-radius: 4px;
    }

        ::deep .rz-textarea::-webkit-scrollbar-thumb:hover {
            background: var(--rz-primary);
        }
</style>