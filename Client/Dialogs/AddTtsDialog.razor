@attribute [Authorize]

<div class="tts-dialog">
    <!-- 헤더 섹션 -->
    <div class="dialog-header">
        <div class="header-content">
            <div class="header-icon-badge">
                <RadzenIcon Icon="record_voice_over" />
            </div>
            <div class="header-text">
                <h2 class="header-title">TTS MESSAGE CREATION</h2>
                <p class="header-subtitle">TTS 메시지 생성</p>
            </div>
        </div>
    </div>

    <div class="dialog-body">

    <!-- 폼 섹션 -->
    <RadzenTemplateForm TItem="TtsFormModel" Data="@model" Submit="@FormSubmit">
        <RadzenStack Gap="1.25rem">
            <!-- 에러 알림 -->
            @if (errorVisible)
            {
                <RadzenAlert AlertStyle="AlertStyle.Danger" 
                             Variant="Variant.Flat" 
                             Shade="Shade.Lighter"
                             AllowClose="false">
                    <RadzenStack Orientation="Orientation.Horizontal" AlignItems="AlignItems.Center" Gap="0.5rem">
                        <RadzenIcon Icon="error_outline" />
                        <RadzenText>@error</RadzenText>
                    </RadzenStack>
                </RadzenAlert>
            }

            <!-- 기본 정보 그룹 -->
            <div class="field-group">
                <div class="field-group-header">
                    <RadzenIcon Icon="info" class="field-group-icon" />
                    <span class="field-group-title">메시지 정보</span>
                </div>
                
                <RadzenFormField Text="제목" Variant="Variant.Outlined" class="form-field">
                    <ChildContent>
                        <RadzenTextBox @bind-Value="@model.Name" 
                                       Name="Name"
                                       Placeholder="오전 안내 방송"
                                       class="w-100" />
                    </ChildContent>
                </RadzenFormField>
                <RadzenRequiredValidator Component="Name" 
                                         Text="제목은 필수 입력 항목입니다" />

                <RadzenFormField Text="음성 변환 텍스트" Variant="Variant.Outlined" class="form-field">
                    <ChildContent>
                        <RadzenTextArea @bind-Value="@model.Content" 
                                        Name="Content"
                                        Rows="6"
                                        Placeholder="음성으로 변환할 텍스트를 입력하세요..."
                                        class="w-100" />
                    </ChildContent>
                    <Helper>
                        <div class="field-helper">
                            <span>명확한 발음을 위해 문장 부호를 적절히 사용하세요</span>
                            <span class="character-count">
                                <RadzenIcon Icon="text_format" Style="font-size: 0.75rem;" />
                                @(model.Content?.Length ?? 0) / 1000
                            </span>
                        </div>
                    </Helper>
                </RadzenFormField>
                <RadzenRequiredValidator Component="Content" 
                                         Text="내용은 필수 입력 항목입니다" />
            </div>

            <!-- 음성 설정 그룹 -->
            <div class="field-group">
                <div class="field-group-header">
                    <RadzenIcon Icon="settings_voice" class="field-group-icon" />
                    <span class="field-group-title">음성 설정</span>
                </div>

                <RadzenFormField Text="음성 타입" Variant="Variant.Outlined" class="form-field">
                    <ChildContent>
                        <RadzenDropDown @bind-Value="@model.VoiceType"
                                        Data="@voiceTypes"
                                        TextProperty="Text"
                                        ValueProperty="Value"
                                        Name="VoiceType"
                                        class="w-100" />
                    </ChildContent>
                </RadzenFormField>
            </div>

            <!-- 안내 정보 -->
            <div class="info-notice">
                <div class="notice-header">
                    <RadzenIcon Icon="info" class="notice-icon" />
                    <span class="notice-title">TTS 생성 가이드</span>
                </div>
                <ul class="notice-list">
                    <li>최대 1000자까지 입력 가능합니다</li>
                    <li>구두점(마침표, 쉼표)을 사용하면 자연스러운 음성이 생성됩니다</li>
                    <li>숫자는 자동으로 한글로 변환되어 읽혀집니다</li>
                    <li>생성된 TTS는 채널에 할당하여 방송에 사용할 수 있습니다</li>
                </ul>
            </div>
        </RadzenStack>

        <!-- 푸터 섹션 - Form 안으로 이동 -->
        <div class="dialog-footer">
            <div class="footer-hint">
                <RadzenIcon Icon="mic" />
                <span>입력한 텍스트가 음성으로 변환됩니다</span>
            </div>
            <div class="footer-actions">
                <RadzenButton ButtonStyle="ButtonStyle.Light"
                              Text="취소"
                              Click="@CancelClick"
                              Variant="Variant.Outlined"
                              Disabled="@isProcessing"
                              class="btn-cancel" />
                @if (isProcessing)
                {
                    <RadzenButton ButtonType="ButtonType.Submit"
                                  ButtonStyle="ButtonStyle.Primary"
                                  Text="생성 중..."
                                  Icon="sync"
                                  IsBusy="true"
                                  Disabled="true"
                                  class="btn-submit" />
                }
                else
                {
                    <RadzenButton ButtonType="ButtonType.Submit"
                                  ButtonStyle="ButtonStyle.Primary"
                                  Icon="add_circle"
                                  Text="생성"
                                  class="btn-submit" />
                }
            </div>
        </div>
    </RadzenTemplateForm>
    
    </div>
</div>

<style>
    /* ========================================
       다이얼로그 스타일
       ======================================== */
    .tts-dialog {
        width: 100%;
        max-width: 780px;
        font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
        background: var(--rz-base-background-color);
        border-radius: 4px;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
    }

    /* ========================================
       헤더 섹션 스타일
       ======================================== */
    .dialog-header {
        background: linear-gradient(135deg, #1a237e 0%, #283593 100%);
        padding: 1.5rem 2rem;
        border-bottom: 3px solid rgba(255, 255, 255, 0.1);
        position: relative;
        overflow: hidden;
    }

    .dialog-header::before {
        content: '';
        position: absolute;
        top: 0;
        right: 0;
        width: 200px;
        height: 200px;
        background: radial-gradient(circle, rgba(255, 255, 255, 0.08) 0%, transparent 70%);
        pointer-events: none;
    }

    .header-content {
        display: flex;
        align-items: center;
        gap: 1.25rem;
        position: relative;
        z-index: 1;
    }

    .header-icon-badge {
        width: 48px;
        height: 48px;
        background: rgba(255, 255, 255, 0.15);
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.2);
    }

    .header-icon-badge .rz-icon {
        font-size: 24px !important;
        color: white !important;
    }

    .header-text {
        flex: 1;
    }

    .header-title {
        margin: 0;
        font-size: 1.1rem;
        font-weight: 600;
        color: white;
        letter-spacing: 0.15em;
        text-transform: uppercase;
        line-height: 1.2;
    }

    .header-subtitle {
        margin: 0.35rem 0 0 0;
        font-size: 0.8rem;
        color: rgba(255, 255, 255, 0.85);
        font-weight: 400;
        letter-spacing: -0.01em;
    }

    /* ========================================
       다이얼로그 바디 스타일
       ======================================== */
    .dialog-body {
        padding: 2rem;
        background: var(--rz-base-background-color);
    }

    /* ========================================
       필드 그룹 스타일
       ======================================== */
    .field-group {
        background: var(--rz-base-background-color);
        border: 2px solid var(--rz-border-color);
        border-radius: 6px;
        padding: 1.25rem;
        transition: all 0.2s ease;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.08);
        margin-bottom: 1.5rem;
    }

    .field-group:hover {
        border-color: var(--rz-primary);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .field-group-header {
        display: flex;
        align-items: center;
        gap: 0.65rem;
        margin-bottom: 1rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid var(--rz-border-color);
    }

    .field-group-icon {
        font-size: 16px !important;
        color: var(--rz-primary) !important;
        opacity: 0.8;
    }

    .field-group-title {
        font-size: 0.7rem;
        font-weight: 600;
        color: var(--rz-text-secondary-color);
        letter-spacing: 0.12em;
        text-transform: uppercase;
    }

    /* ========================================
       폼 필드 스타일
       ======================================== */
    .form-field {
        margin-bottom: 1rem;
    }

    .form-field:last-child {
        margin-bottom: 0;
    }

    .tts-dialog .rz-form-field label {
        font-size: 0.75rem !important;
        font-weight: 500 !important;
        color: var(--rz-text-color) !important;
        margin-bottom: 0.4rem !important;
        text-transform: uppercase;
        letter-spacing: 0.03em;
    }

    .tts-dialog .rz-textbox,
    .tts-dialog .rz-textarea,
    .tts-dialog .rz-dropdown,
    .tts-dialog .rz-numeric {
        font-size: 0.85rem !important;
        padding: 0.65rem 0.85rem !important;
        border-radius: 3px !important;
        border: 1px solid var(--rz-border-color) !important;
        background: var(--rz-base-background-color) !important;
        transition: all 0.2s ease !important;
    }

    .tts-dialog .rz-textbox:focus,
    .tts-dialog .rz-textarea:focus,
    .tts-dialog .rz-dropdown:focus,
    .tts-dialog .rz-numeric:focus {
        border-color: var(--rz-primary) !important;
        box-shadow: 0 0 0 3px rgba(26, 35, 126, 0.1) !important;
        outline: none !important;
    }

    /* Helper 텍스트 */
    .field-helper {
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-size: 0.7rem;
        color: var(--rz-text-secondary-color);
    }

    .character-count {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-weight: 600;
        color: var(--rz-primary);
    }

    /* ========================================
       안내 정보 스타일
       ======================================== */
    .info-notice {
        background: var(--rz-base-background-color);
        border: 1px solid var(--rz-border-color);
        border-left: 4px solid var(--rz-info);
        border-radius: 3px;
        padding: 1.25rem;
    }

    .notice-header {
        display: flex;
        align-items: center;
        gap: 0.65rem;
        margin-bottom: 0.85rem;
    }

    .notice-icon {
        font-size: 16px !important;
        color: var(--rz-info) !important;
    }

    .notice-title {
        font-size: 0.7rem;
        font-weight: 600;
        color: var(--rz-text-secondary-color);
        letter-spacing: 0.12em;
        text-transform: uppercase;
    }

    .notice-list {
        margin: 0;
        padding-left: 1.5rem;
        list-style: none;
    }

    .notice-list li {
        font-size: 0.75rem;
        color: var(--rz-text-secondary-color);
        line-height: 1.8;
        position: relative;
        padding-left: 0.5rem;
    }

    .notice-list li::before {
        content: '•';
        position: absolute;
        left: -0.75rem;
        color: var(--rz-info);
        font-weight: bold;
    }

    /* ========================================
       푸터 스타일
       ======================================== */
    .dialog-footer {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 1.25rem 2rem;
        background: var(--rz-base-background-color);
        border-top: 2px solid var(--rz-border-color);
    }

    .footer-hint {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.75rem;
        color: var(--rz-text-secondary-color);
    }

    .footer-hint .rz-icon {
        font-size: 16px !important;
        color: var(--rz-success) !important;
    }

    .footer-actions {
        display: flex;
        gap: 0.75rem;
    }

    /* ========================================
       버튼 스타일
       ======================================== */
    .btn-cancel,
    .btn-submit {
        font-size: 0.8rem !important;
        font-weight: 500 !important;
        padding: 0.6rem 1.5rem !important;
        border-radius: 3px !important;
        text-transform: uppercase;
        letter-spacing: 0.05em;
        transition: all 0.2s ease !important;
    }

    .btn-cancel {
        border: 1px solid var(--rz-border-color) !important;
        background: var(--rz-base-background-color) !important;
        color: var(--rz-text-secondary-color) !important;
    }

    .btn-cancel:hover:not(:disabled) {
        border-color: var(--rz-text-secondary-color) !important;
        background: var(--rz-base-100) !important;
    }

    .btn-submit {
        background: linear-gradient(135deg, #1a237e 0%, #283593 100%) !important;
        border: none !important;
        color: white !important;
        box-shadow: 0 2px 8px rgba(26, 35, 126, 0.3) !important;
    }

    .btn-submit:hover:not(:disabled) {
        box-shadow: 0 4px 12px rgba(26, 35, 126, 0.4) !important;
        transform: translateY(-1px);
    }

    /* ========================================
       유틸리티 스타일
       ======================================== */
    .w-100 {
        width: 100%;
    }

    /* Validator 스타일 */
    .tts-dialog .rz-message {
        font-size: 0.7rem !important;
        margin-top: 0.35rem !important;
    }

    /* Alert 스타일 */
    .tts-dialog .rz-alert {
        border-radius: 3px !important;
    }

    .tts-dialog .rz-alert .rz-text {
        font-size: 0.8rem !important;
    }

    /* ========================================
       반응형 스타일
       ======================================== */
    @@media (max-width: 768px) {
        .dialog-body {
            padding: 1.5rem;
        }

        .dialog-header {
            padding: 1.25rem 1.5rem;
        }

        .dialog-footer {
            padding: 1rem 1.5rem;
            flex-direction: column;
            gap: 1rem;
        }

        .footer-actions {
            width: 100%;
            justify-content: stretch;
        }

        .btn-cancel,
        .btn-submit {
            flex: 1;
        }
    }

    /* ========================================
       애니메이션 스타일
       ======================================== */
    @@keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .tts-dialog {
        animation: slideDown 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }
</style>
